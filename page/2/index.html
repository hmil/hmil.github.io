<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="XEkaOnI5YgD6GPlLusy7Z7U91v35YU9Q0eX1KslsVoQ" />
  

  
  <title>hmil&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="hmil&#39;s blog">
<meta property="og:url" content="https://hmil.github.io/page/2/index.html">
<meta property="og:site_name" content="hmil&#39;s blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hmil&#39;s blog">
  
    <link rel="alternate" href="/atom.xml" title="hmil&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">hmil&#39;s blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">random tech write-ups</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hmil.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript/" class="article-date">
  <time datetime="2017-08-01T13:05:10.000Z" itemprop="datePublished">2017-08-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/software-engineering/">software engineering</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript/">Deal with nullables like they&#39;re not even here - Good coding practices in TypeScript.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Today we will take a look at a couple ways to improve your TypeScript code. By applying those techniques we will get code that is more readable, contains less bugs and is objectively higher-level without any downside. How cool is that ?</p>
<h2 id="An-example-to-get-started"><a href="#An-example-to-get-started" class="headerlink" title="An example to get started"></a>An example to get started</h2><p>I like to use examples to illustrate what I’m talking about, so let’s start with the following code:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> User &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">            <span class="keyword">public</span> name: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** A user may want to fetch her introduction sentence from an async source so</span></span><br><span class="line"><span class="comment">      * we use a callback to handle the asynchronous execution flow.</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">public</span> introduce(cb: <span class="function">(<span class="params">msg: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        setImmediate(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            cb(<span class="string">`Hello, my name is <span class="subst">$&#123;this.name&#125;</span>`</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> App &#123;</span><br><span class="line">    user?: User;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> login(user: User): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> renameUser(newName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> introduceUser(cb: <span class="function">(<span class="params">err: <span class="built_in">string</span> | <span class="literal">null</span>, msg?: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user.introduce(<span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">            cb(<span class="literal">null</span>, msg);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> App();</span><br><span class="line">app.introduceUser(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;);</span><br><span class="line">app.login(<span class="keyword">new</span> User(<span class="string">'John'</span>));</span><br><span class="line">app.introduceUser(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>This useless piece of code simply illustrates the case where we have a class (Here <strong>App</strong> containing a member which may be null (<strong>user</strong>).</p>
<p>I already hear functional programming geeks yelling at me, arguing that mutable values are bad and nullable ones are even worse.<br>The thing is, in practice there will always be a piece of stateful code with a nullable in there, and although you can avoid it with FP trickery, I want to show you that we can achieve the same amount of protection without sacrificing the ease and comfort we get out of nullables.</p>
<p>OK, let’s get back to business, the above piece of code is bad for an obvious reason. Since <strong>user</strong> may be undefined, calling introduceUser may result in an error.</p>
<h2 id="strictNullChecks"><a href="#strictNullChecks" class="headerlink" title="strictNullChecks"></a>strictNullChecks</h2><p>The first step is to turn on the strictNullChecks <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" target="_blank" rel="noopener">compiler option</a> in the project’s tsconfig.json.<br>What this flag does is that it considers the <code>null</code> and <code>undefined</code> types as completely independent types and thus prevents accidental casting and/or calling methods on variables with those types.<br>It makes sense that this flag is off by default because TypeScript needs to be as close to JavaScript as possible to ease the learning curve. However, using TypeScript in production without –strictNullChecks is insane. Anytime a nullable value is used without any check <strong>is an error</strong>.</p>
<p>Now, with the –strictNullChecks flag enabled, our code above won’t compile anymore, so we know we need to handle the case where user is null. The obvious way to do it is to add simple null checks.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> App &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> renameUser(newName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'No user is logged in!'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.user.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> introduceUser(cb: <span class="function">(<span class="params">err: <span class="built_in">string</span> | <span class="literal">null</span>, msg?: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> cb(<span class="string">'No user is logged in!'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.user.introduce(<span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">            cb(<span class="literal">null</span>, msg);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Note that since the method introduceUser is using a nodeJS-style asynchronous control flow, we need to call the callback with the error as the first parameter.</p>
<p>The TypeScript compiler analyses the control flow and sees that, because of the newly added null check, the references to the user member are safe.</p>
<p>This works in practice but has two downsides:<br>1. As your class grows, the number of null checks grows linearly. Each additional branch makes each method more <a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity" target="_blank" rel="noopener">complex</a> and less readable.<br>2. We need to duplicate the error message which goes against the DRY principle. (even if we factor out the string itself, the string identifier will have to be duplicated anyway.)</p>
<h2 id="Using-getters"><a href="#Using-getters" class="headerlink" title="Using getters"></a>Using getters</h2><p>Who said getters were only good for public interfaces? In this scenario we can actually use a getter to reduce the number of branches in our class and make the code more readable.<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> App &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> getUser(): User &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.user) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'No user is logged in!'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> renameUser(newName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.getUser().name = newName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> introduceUser(cb: <span class="function">(<span class="params">err: <span class="built_in">string</span> | <span class="literal">null</span>, msg?: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.getUser().introduce(<span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">            cb(<span class="literal">null</span>, msg);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>The getter allows us to factor-out the null-check and our public methods are readable again. If calling getUser() each time looks bad to your taste and you target ES5 or higher, you can actually rewrite the App class using an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get" target="_blank" rel="noopener">ES5 getter</a> like this:<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> App &#123;</span><br><span class="line">    _user?: User;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> login(user: User): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>._user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">get</span> user(): User &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>._user) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'No user is logged in!'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> renameUser(newName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> introduceUser(cb: <span class="function">(<span class="params">err: <span class="built_in">string</span> | <span class="literal">null</span>, msg?: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user.introduce(<span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">            cb(<span class="literal">null</span>, msg);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The most attentive reader might notice that we are back to square one: If the API consumer calls app.renameUser() or app.introduceUser() before logging in, they will get an exception! Even worse, our asynchronous control flow is broken because the callback will never be invoked with an error.</p>
<p>We’ll talk about the asynchronous case in a minute, but first I need to mention one huge advantage this solution has over the initial version: The “unhappy” path is managed.</p>
<p>Before, we relied on the JS engine to crash when the user variable was undefined. The API consumer would get something like “undefined has no member ‘name’”. Any JS dev knows how annoying it is to dig through dozens of stack trace frames to find out what was undefined and why. This kind of error is a legit software bug.<br>On the other hand, what we got now is an error that we are aware of. We know it may happen, we know why and we know what to do if it does happen. We can even show the error to the end user in the UI because “You are not authenticated” sounds better to end users than “Undefined is not a function”!!!</p>
<p>This is the reason why –strictNullChecks is so important, it helps you, the programmer, avoid bugs. Your users might still get an error but you expect it and you can document it.</p>
<h2 id="Making-it-airtight"><a href="#Making-it-airtight" class="headerlink" title="Making it airtight"></a>Making it airtight</h2><p>There is one last issue with the current solution: the asynchronous workflow. Indeed, while languages like Java have compile-time checks to prevent you from throwing exceptions where you shouldn’t, TypeScript doesn’t, and even if it did, you could still easily make a mess of your interface declarations.<br>TypeScript can only protect unchecked access to nullables in a synchronous workflow and that is why we have no other solution but to throw an Error in our getter.<br>By now you should know that whenever you have a problem with your asynchronous workflow, it’s because you are not using enough promises. Let’s see what promises can do for us in this case.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> App &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> renameUser(newName: <span class="built_in">string</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.user.name = newName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> introduceUser(): <span class="built_in">Promise</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.user.introduce(<span class="function">(<span class="params">s</span>) =&gt;</span> resolve(s));</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> App();</span><br><span class="line">app.introduceUser().then(<span class="built_in">console</span>.log, <span class="built_in">console</span>.error);</span><br><span class="line">app.login(<span class="keyword">new</span> User(<span class="string">'John'</span>));</span><br><span class="line">app.introduceUser().then(<span class="built_in">console</span>.log, <span class="built_in">console</span>.error);</span><br></pre></td></tr></table></figure>
<p><em>note: The promise API is <a href="https://caniuse.com/#search=promises" target="_blank" rel="noopener">available</a> in node and all major browsers, except IE</em></p>
<p>When you wrap code in a promise like so, any exception emitted within the execution context of the promise is caught and used to reject the promise itself. Therefore, you get a consistent error handling mechanism where no exception may leak out.</p>
<p>We now have:</p>
<ul>
<li>synchronous methods that return the result or throw an exception</li>
<li>asynchronous methods that fullfill a promise or reject it with an error</li>
<li>Readable code and managed errors</li>
</ul>
<p>As advertised in the introduction, we made our code better with no downside at all!</p>
<h2 id="TL-DR-To-remember"><a href="#TL-DR-To-remember" class="headerlink" title="TL;DR / To remember"></a>TL;DR / To remember</h2><ul>
<li>Always use the –strictNullChecks compiler option</li>
<li><p>Dont be ashamed of nullable values, but if you do need one:</p>
<ul>
<li>Always access a nullable through a getter, even within the private context of a class</li>
<li>Find the high level meaning of such a null value and throw a user-friendly error in the getter</li>
<li>Wrap all async code in a promise and always write promise-based async APIs (no more node-style callbacks)<br>Check-out the <a href="https://gist.github.com/hmil/d4034d013dacb198992567cbe31150c5" target="_blank" rel="noopener">gist</a> of this guide if you prefer reading code.</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hmil.github.io/2017/08/archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript/" data-id="cjh6d84da001ml3yhx2s7omec" class="article-share-link">Share</a>
      
        <a href="https://hmil.github.io/2017/08/archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TypeScript/">TypeScript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-archive/you-should-worry-about-vary" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/archive/you-should-worry-about-vary/" class="article-date">
  <time datetime="2016-10-16T01:49:15.000Z" itemprop="datePublished">2016-10-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hacking/">hacking</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/archive/you-should-worry-about-vary/">You should worry about Vary</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>We’ve all heard of XSS, SQLi and CSRF. And although they keep occurring all the time, any decent web framework nowadays has some mechanisms to avoid those. Now did you know CSRF had a little sister? It is so poorly known that it seems like it doesn’t even have its own name! Before explaining how it works, let’s see what it can do.</p>
<h1 id="Some-background"><a href="#Some-background" class="headerlink" title="Some background"></a>Some background</h1><p>Meet Bob, a web dev who is in charge of writing a public facing API. Bob sets the Access-Control-Allow-Origin header to allow all origin domains. Indeed, Bob wants any website to be able to talk to his API. Now, being a thoughtful developer, Bob knows about <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet" target="_blank" rel="noopener">CSRF</a> and he builds an authentication mechanism that delivers access tokens. Without a proper access token, his API won’t talk!</p>
<p>Still following? Good, now you may be wondering what this API does. In fact this API allows different services to store and share credentials in the cloud. The way a service gets the credentials is by issuing a request like this one:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /vault/&#123;account&#125;/&#123;service&#125;</span><br><span class="line">Authorization: Basic QWxhZGRpbjpPcGVuU2VzYW1l</span><br></pre></td></tr></table></figure></p>
<p>Bob heard one day that Auth basic is unbreakable, therefore he is using this method to pass the API key and username.<br>But the backend is doing some crypto stuff and hence requesting the credentials is an expensive operation. Bob adds some Cache-Control information to tell the browser to cache the response for a little bit. This way Bob reduces the load on his server and improves the speed of apps consuming his API.<br>If the credentials check out, the API returns something like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">200 OK</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: Authorization</span><br><span class="line">Cache-Control: no-transform, max-age=600</span><br><span class="line">Content-Length: 42</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;Alice&quot;,&quot;password&quot;:&quot;I4mab055&quot;&#125;</span><br></pre></td></tr></table></figure></p>
<p>Everything works fine until one day, a client complains that her credentials got stolen…<br>Damn it Bob, again?!</p>
<h1 id="You-just-got-hit"><a href="#You-just-got-hit" class="headerlink" title="You just got hit"></a>You just got hit</h1><p>Bob can check his server log for a while, he will never find anything. The attacker left no evidence behind because he <strong>never even had to talk to Bob’s API</strong>; Everything happened locally, in Alice’s browser. Alice received this stupid email a few days ago and couldn’t resist opening a link to a picture of a <a href="https://i.reddituploads.com/3a16089469a04fe2bec7c3666b3bf169?fit=max&amp;h=1536&amp;w=1536&amp;s=6160f4d2e6b39bb1c1684416878ec2dc" target="_blank" rel="noopener">cat wearing a ninja-turtle mask</a>.<br>While she was watching this picture, a piece of javascript issued an HTTP request in the background to Bob’s API and stole her credentials. But how did the malicious website get an API token in the first place you’ll ask? Well it didn’t. Because it never had to. <strong>A simple request without the Authorization header was enough to get the information.</strong></p>
<h1 id="Introducing-Vary"><a href="#Introducing-Vary" class="headerlink" title="Introducing: Vary"></a>Introducing: Vary</h1><p>So there’s this thing in the HTTP spec that you may or may not have heard about. It’s called the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Vary" target="_blank" rel="noopener">Vary</a> header. What it does is inform any cache about which request headers can cause the response to change. <strong>If the Vary header is omitted, then caches will disregard the request headers when deciding whether to serve the response from cache.</strong> In other words, no matter which headers were sent by the client the first time, the response will be cached and served back to every subsequent request until the response expires, regardless of the next request’s headers. Remember how Bob made the response cacheable for 10 minutes? This means that the attack is successful if it happens within 10 minutes of the original request.</p>
<p>To prevent this issue, the API should send the <em>Vary</em> header in its responses to inform caches that the response will be different for different values of the <em>Authorization</em> header. In our example we get:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">200 OK</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: Authorization</span><br><span class="line">Cache-Control: no-transform, max-age=600</span><br><span class="line">Content-Length: 42</span><br><span class="line">Content-Type: application/json</span><br><span class="line">**Vary: Authorization**</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;Alice&quot;,&quot;password&quot;:&quot;I4mab055&quot;&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="Going-beyond"><a href="#Going-beyond" class="headerlink" title="Going beyond"></a>Going beyond</h1><p>So stealing information is fun but let’s see if we can use this flaw to do something better. Imagine a web page that allows a user to set a message of the day, stores it in the cookies and displays it whenever the user visits the page for the rest of the day. The page is cached and can be fetched cross-domain just like in the previous example and it doesn’t have <em>Vary: Cookie</em>. If a user visits my website, I could issue a request to the greetings page with a custom Cookie. If I manage to perform this request when the page is not in cache yet, then the browser will fetch the page with my custom cookie and store it. Yes, we just found ourselves a cache-poisoning vulnerability. Now guess what happens next if this page allows the greeting message to contain javascript?</p>
<p>Depending on the cache headers, it may even be possible that the response gets cached on a server sitting between the victim and the origin. In this situation the attacker can read the victim’s data without even running code in her browser! All that is required is a hit on the cache server.</p>
<h1 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h1><p>I wish this article will at least allow a few people to get awareness about the dangers associated with Cache-Control and the Vary header. This vulnerability is similar to CSRF in that it allows cross domain requests to do some damage. It is harder to exploit and does not allow to reach the server. This however makes it impossible to detect attacks while still allowing some information leakage and defacing. In the case of cache poisoning, it opens up the attacks surface to find other vulnerabilities such as XSS or even SQL injections.</p>
<p>The fact that this vulnerability lies in the shadow of the big names like XSS makes it more likely to be looked over. In fact it <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1418" target="_blank" rel="noopener">has occurred before</a> and I bet there are exploitable scenarios in the wild like those discussed above. So be careful next time you build an API and take some time to review your response headers. It can sometimes be trickier than you’d think figuring out which headers make the response change!</p>
<p>You may want to try out <a href="https://github.com/hmil/invariable-leak" target="_blank" rel="noopener">this quick and dirty proof of concept</a> to see this flaw in action.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hmil.github.io/2016/10/archive/you-should-worry-about-vary/" data-id="cjh6d84di001yl3yhkz9dd32y" class="article-share-link">Share</a>
      
        <a href="https://hmil.github.io/2016/10/archive/you-should-worry-about-vary/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-archive/githubs-merge-pull-request-is-wrong" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/archive/githubs-merge-pull-request-is-wrong/" class="article-date">
  <time datetime="2015-11-21T13:49:06.000Z" itemprop="datePublished">2015-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/software-engineering/">software engineering</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/archive/githubs-merge-pull-request-is-wrong/">GitHub&#39;s &#34;merge pull request&#34; is wrong</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This is the story of Bob. Bob is working on some cool project on github. He’s written tests and runs them continuously on <a href="https://travis-ci.org" target="_blank" rel="noopener">travis</a>. Bob asks his contributors to write tests for new features they introduce. Using GitHub’s pull requests, he can make sure no bugs are introduced by looking for the green tick next to the commit number. If you look at the commit tree in Bob’s repository, you’ll probably find something like <a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">this</a>.</p>
<p>Bob states in his contribution guide that people can fork <em>master</em> to work on new features. He guarantees that master’s tests always pass and therefore, individual contributors don’t need to worry that much about errors made by other developers.</p>
<p>If you’re familiar with github then you are probably familiar with this workflow and you’ll think that it’s perfectly reasonable.</p>
<p>But you’ll be wrong. Bob got overly enthusiastic about github’s UI and will soon discover that <strong>he’s been wrong all this time</strong>.</p>
<h2 id="A-catastrophic-scenario"><a href="#A-catastrophic-scenario" class="headerlink" title="A catastrophic scenario"></a>A catastrophic scenario</h2><p>Say two contributors, Alice and Charlie, are writing code for Bob’s project in their respective branches. In this project, we find the following code for operating Bob’s car:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String action)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"OPEN_DOOR"</span>:</span><br><span class="line">       open_door();</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Now Alice thinks it would be better if Bob used an <strong>enum</strong> instead of a string. She changes the function to the following and opens a pull request on Bob’s project.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Action action)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">    <span class="keyword">case</span> Action.OPEN_DOOR:</span><br><span class="line">       open_door();</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Bob opens his project page and sees a pull request. He thinks Alice’s modification makes sense and, since all tests passed, he clicks on <em>the green button</em>.</p>
<p>[caption id=”attachment_221” align=”alignnone” width=”776”]<a href="/assets/archive/2015/11/button_of_doom.png"><img src="/assets/archive/2015/11/button_of_doom.png" alt="The button of doom"></a> The button of doom[/caption]</p>
<p>Meanwhile, Charlie thinks Bob will need to close his car’s door at some point. Charlie adds a new case to the switch:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String action)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"OPEN_DOOR"</span>:</span><br><span class="line">       open_door();</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"CLOSE_DOOR"</span>:</span><br><span class="line">       close_door();</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The next day, Bob opens his project on GitHub and sees Charlie’s pull request. All tests passed, no merge conflict, that’s a clear <acronym title="Looks Good To Me">LGTM</acronym> and Bob merges the code.</p>
<p>A few days later, Bob receives complaints from multiple developers, they forked master and it doesn’t build!</p>
<h2 id="What-could-go-wrong"><a href="#What-could-go-wrong" class="headerlink" title="What could go wrong?"></a>What could go wrong?</h2><p>The problem lies in a common misunderstanding of the following assumptions. </p>
<ul>
<li>Different PRs must be completely independent</li>
<li>No merge conflicts &ne; No conflicts</li>
</ul>
<p>If you accept one of these to be violated, then expect your main branch to fail tests!</p>
<p>If we speak in terms of diff, then Alice’s diff is the following:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String action)</span> </span>&#123;</span><br><span class="line">+ <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Action action)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">-     <span class="keyword">case</span> <span class="string">"OPEN_DOOR"</span>:</span><br><span class="line">+     <span class="keyword">case</span> Action.OPEN_DOOR:</span><br><span class="line">         open_door();</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>While Bob’s diff looks like this:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">+     <span class="keyword">case</span> <span class="string">"CLOSE_DOOR"</span>:</span><br><span class="line">+        close_door();</span><br><span class="line">+        <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>Put together we get<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(String action)</span> </span>&#123;</span><br><span class="line">+ <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">(Action action)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">-     <span class="keyword">case</span> <span class="string">"OPEN_DOOR"</span>:</span><br><span class="line">+     <span class="keyword">case</span> Action.OPEN_DOOR:</span><br><span class="line">         open_door();</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">+     <span class="keyword">case</span> <span class="string">"CLOSE_DOOR"</span>:</span><br><span class="line">+        close_door();</span><br><span class="line">+        <span class="keyword">break</span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>This diff <strong>does not cause a merge conflict</strong> but it is actually in conflict!</p>
<h2 id="–no-ff-and-the-button-of-doom"><a href="#–no-ff-and-the-button-of-doom" class="headerlink" title="–no-ff and the button of doom"></a>–no-ff and the button of doom</h2><p>The flaw resides in that big old “merge pull request” button. While the green checks above the button and its fat style make pressing it a rewarding thing, it hides the real danger behind it: a blind merge!</p>
<p>The above example looks like this in terms of commit history:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">       +-PR_Charlie-+</span><br><span class="line">      /              \</span><br><span class="line">     +--PR_Alice--+   \</span><br><span class="line">    /              \   \</span><br><span class="line">---+----------------x---x</span><br><span class="line">                        |</span><br><span class="line">                       master</span><br></pre></td></tr></table></figure></p>
<p>All changes introduced by Alice and Charlie on their respective PRs have been tested, but the merge commits (marked ‘x’ above) were not! This is called a “non fast-forward” merge (–no-ff in git) and is basically like committing directly on master.</p>
<h2 id="The-right-way-to-do-it"><a href="#The-right-way-to-do-it" class="headerlink" title="The right way to do it"></a>The right way to do it</h2><p>Assuming you are like Bob and want your main branch to always pass tests, then here is the right way to do this: Merge master into the PR fisrt, and merge only when fast forward. It would look like that:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">Initial state: both PRs are unmerged:</span><br><span class="line"></span><br><span class="line">        +-PR_Charlie-+</span><br><span class="line">       /              </span><br><span class="line">      +--PR_Alice--+  </span><br><span class="line">     /                 </span><br><span class="line"> ---+</span><br><span class="line">    |</span><br><span class="line">  master</span><br><span class="line"></span><br><span class="line">on master: git merge --ff-only PR_Alice</span><br><span class="line"></span><br><span class="line">      +-PR_Charlie-+</span><br><span class="line">     /                              </span><br><span class="line"> ---+--PR_Alice--+</span><br><span class="line">                 |</span><br><span class="line">               master</span><br><span class="line"></span><br><span class="line">on PR_Charlie: git merge master</span><br><span class="line"></span><br><span class="line">                  merge branch master into PR_Charlie   </span><br><span class="line">                     |</span><br><span class="line">      +-PR_Charlie-+-+</span><br><span class="line">     /              /                  </span><br><span class="line"> ---+--PR_Alice----+</span><br><span class="line">                   |</span><br><span class="line">                 master</span><br><span class="line"></span><br><span class="line">Then on master: git merge --ff-only PR_Charlie</span><br><span class="line"></span><br><span class="line">      +-PR_Charlie-+</span><br><span class="line">     /              \                  </span><br><span class="line"> ---+--PR_Alice----+-+</span><br><span class="line">                     |</span><br><span class="line">                   master</span><br></pre></td></tr></table></figure>
<p>The end result is exactly the same as before EXCEPT that master was merged into the PR first, and this (if properly pushed to github) allows the automated tools to test the last commit. This ensures that master builds because master will always be on a commit that has been tested before.</p>
<p>Many beginner (and even advanced) programmers get fooled into thinking that merging a green pull request cannot harm. In an ideal world, clicking the green button would: merge master into the branch, wait for the tests to pass, and on success, fast-forward master to the merge commit. But unfortunately I don’t think this is coming anytime soon. In the meantime, think about it twice before you press the <em>button of doom</em>. And when in doubt, run the merge sequence manually in the right order. This may save you a few hours of debugging.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hmil.github.io/2015/11/archive/githubs-merge-pull-request-is-wrong/" data-id="cjh6d84dd001ql3yhbde31qvl" class="article-share-link">Share</a>
      
        <a href="https://hmil.github.io/2015/11/archive/githubs-merge-pull-request-is-wrong/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/archived/">archived</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hacking/">hacking</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/random/">random</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/software-engineering/">software engineering</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/TypeScript/" style="font-size: 20px;">TypeScript</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/architecture/" style="font-size: 15px;">architecture</a> <a href="/tags/funrun/" style="font-size: 10px;">funrun</a> <a href="/tags/funrun2/" style="font-size: 10px;">funrun2</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hack/" style="font-size: 10px;">hack</a> <a href="/tags/monorepo/" style="font-size: 15px;">monorepo</a> <a href="/tags/reverse-engineering/" style="font-size: 10px;">reverse engineering</a> <a href="/tags/satire/" style="font-size: 10px;">satire</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/The-github-etiquette/">How not to suck at GitHub</a>
          </li>
        
          <li>
            <a href="/2018/05/TypeScript-project-structure2/">How to manage and publish a multi-package TypeScript project</a>
          </li>
        
          <li>
            <a href="/2018/03/TypeScript-project-structure/">Tips and tricks to structure multi-package TypeScript projects</a>
          </li>
        
          <li>
            <a href="/2017/08/archive/deal-with-nullables-like-theyre-not-even-here-good-coding-practices-in-typescript/">Deal with nullables like they&#39;re not even here - Good coding practices in TypeScript.</a>
          </li>
        
          <li>
            <a href="/2016/10/archive/you-should-worry-about-vary/">You should worry about Vary</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Hadrien Milano<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'hmil';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>